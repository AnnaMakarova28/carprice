# carprice

---

# Выводы по проекту

## 1. Что было сделано

В рамках проекта была решена задача регрессии для предсказания стоимости автомобилей.

Основные этапы работы:

1. **EDA и первичный анализ данных**

   * Изучены датасеты (пропуски, дубликаты, структура данных, особенности распределений).
   * С помощью `ydata_profiling` построен обзорный отчет по данным.
   * Выявлены пропуски в признаках `mileage`, `engine`, `max_power`, `torque`, `seats`, а также значительное число дубликатов.

2. **Очистка данных**

   * Удалены дубликаты по признакам (без учета целевой переменной).
   * Приведены признаки `mileage`, `engine`, `max_power` к числовому виду.
   * Признак `torque` разобран на два отдельных признака: `torque_num` и `max_torque_rpm` с учетом единиц измерения.
   * Пропуски в числовых признаках заполнены медианами, посчитанными по обучающей выборке.

3. **Feature engineering**

   * Созданы дополнительные признаки (`power_per_liter`, `engine_power_mul`, `km_per_year`, `year_sq`).
   * Целевая переменная была логарифмирована для стабилизации распределения (log+1 чтобы избежать лог от 0).

4. **Кодирование категориальных признаков**

   * Выделен бренд автомобиля (`car_label`) из названия.
   * Применен One-Hot Encoding с фиксацией набора признаков по train-выборке (также в качестве категориального признака был представлен признак `seats`).

5. **Обучение модели**

   * Обучены линейные модели (LinearRegression, Ridge, Lasso, ElasticNet).
   * Для Ridge выполнен подбор гиперпараметров с помощью `GridSearchCV`.
   * Оценка качества проводилась с использованием `R²` и MSE в исходном масштабе цены.

6. **Разработка сервиса**

   * Реализован Streamlit-интерфейс для загрузки CSV и получения предсказаний.
   * Обеспечена совместимость признаков между train и test.
   * Добавлена возможность скачивания файла с предсказаниями.

---

## 2. Полученные результаты

Лучшая модель — **Ridge Regression** с подобранными гиперпараметрами.

* **R² (на тесте, в исходном масштабе):** 0.89, что говорит о неплохом качестве объяснения дисперсии цены.
* **RMSE:** достаточно высокая для данной задачи, однако и разброс цен в датасете не совсем типичный.

**Интерпретация:**

* Модель хорошо улавливает влияние мощности двигателя, объема двигателя и года выпуска.
* Логарифмирование таргета позволило уменьшить влияние выбросов и улучшить стабильность модели.

---

## 3. Что дало наибольший прирост качества

Наибольший вклад в улучшение качества дали:

1. **Корректная обработка строковых числовых признаков** (`mileage`, `engine`, `max_power`, `torque`).
2. **Логарифмирование целевой переменной**.
3. **Feature engineering**, особенно признаки, связанные с мощностью и возрастом автомобиля.
4. **Фиксация набора признаков при One-Hot Encoding**, что обеспечило корректную работу модели на тестовых данных и в продакшене.

---

## 4. Разработка Streamlit сервиса

1. Реализовано web-приложение на streamlit для инференса модели прогнозирования цены автомобиля.
2. Добавлена возможность загрузки пользовательского csv-файла через интерфейс.
3. Реализован полный пайплайн предобработки данных, идентичный обучающему.
4. Обеспечена совместимость признаков между обучением и инференсом.
5. Реализовано получение предсказаний в логарифмическом пространстве с обратным преобразованием.
6. Выведены обработанные данные и итоговые предсказания в интерфейсе приложения.
7. Добавлена возможность скачивания файла с результатами предсказаний

### Визуализация

* Табличное отображение предсказаний реализовано - возможность проверить работу предобработки.

### Ограничения и проблемы

* Приложение ожидает строго определенный формат входного файла.
* Нет валидации входных данных и сообщений об ошибках при некорректных колонках.

### Идеи для улучшений

* Сохранить модель вместе с препроцессингом в едином пайплайне.
* Можно добавить визуализации (распределение цен, ошибки).
* Реализовать проверки входного файла и более информативные сообщения пользователю.
* Добавить поддержку одиночного ввода данных через форму.

---

**Итог:**
В ходе проекта был построен полный ML-pipeline: EDA -> обучение модели -> inference-сервис. Полученное решение стабильно, воспроизводимо и готово к дальнейшему развитию.
